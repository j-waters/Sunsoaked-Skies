import s from"../generation/pathfinding.js";export class TaskManager{constructor(e){this.person=e,this._queue=[],this.finished=[]}addMoveTo(e){this._queue.push(new MoveTask(this,e))}clear(){this._queue.length=0}get queue(){return this._queue}get current(){return this._queue[0]}complete(e){this.queue.splice(this.queue.indexOf(e),1),this.finished.push(e),e.isComplete=!0}}export class Task{constructor(e){this.manager=e,this._progress=0,this.total=1,this.isComplete=!1}complete(){this.manager.complete(this)}get progress(){return this._progress/this.total}set progress(e){this._progress=e}get person(){return this.manager.person}}export class MoveTask extends Task{constructor(e,t){super(e);this.target=t}get currentTarget(){return this._route||(this._route=s(this.person,this.target),console.log("specific route: ",this._route.map(e=>e)),this.total=this._route.length),this._route[0]}completeStep(){const e=this.person.room;this.person.setRoom(this.currentTarget.room,this.currentTarget.position),this.person.room!=e&&e.onPersonLeave(),this.progress+=1,this._route.shift(),this._route.length||this.complete()}}
